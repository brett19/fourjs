<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>FOUR Test</title>
    <style type="text/css">
        html, body {
            margin: 0px;
            padding: 0px;
            overflow: hidden;
        }
    </style>
</head>
<body>
<script id="vertexShaderAh" type="x-shader/x-vertex">
        precision mediump float;
        precision mediump int;

        uniform mat4 modelViewMatrix;
        uniform mat4 projectionMatrix;

        attribute vec3 position;
        attribute vec4 color;

        varying vec3 vPosition;
        varying vec4 vColor;

        void main()	{
          vPosition = position;
          vColor = color;
          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
    </script>

<script id="fragmentShaderAh" type="x-shader/x-fragment">
        precision mediump float;
        precision mediump int;

        varying vec3 vPosition;
        varying vec4 vColor;

        void main()	{
          gl_FragColor = vColor;
        }
    </script>

    <script id="vertexShader" type="x-shader/x-vertex">
        precision mediump float;
        precision mediump int;

        uniform mat4 modelViewMatrix;
        uniform mat4 projectionMatrix;

        attribute vec3 position;
        attribute vec2 uv;

        attribute vec4 skinWeight;
        attribute vec4 skinIndex;
        uniform mat4 boneMatrices[48];

        varying vec3 vPosition;
        varying vec2 vUv;

        void main()	{
          //vUv = uv;
          //gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1);

          mat4 mx = boneMatrices[int(skinIndex.x)];
          mat4 my = boneMatrices[int(skinIndex.y)];
          mat4 mz = boneMatrices[int(skinIndex.z)];
          mat4 mw = boneMatrices[int(skinIndex.w)];

          vec4 skinPos = vec4(position, 1.0);
          vec4 skinnedPos = vec4(0.0);
          skinnedPos += mx * skinPos * skinWeight.x;
          skinnedPos += my * skinPos * skinWeight.y;
          skinnedPos += mz * skinPos * skinWeight.z;
          skinnedPos += mw * skinPos * skinWeight.w;

          vPosition = skinnedPos.xyz;
          vUv = uv;
          gl_Position = projectionMatrix * skinnedPos;
        }
    </script>

    <script id="fragmentShader" type="x-shader/x-fragment">
        precision mediump float;
        precision mediump int;

        uniform sampler2D texTest;

        varying vec3 vPosition;
        varying vec2 vUv;

        void main()	{
          #ifdef ROSE_SPECULAR
            gl_FragColor = vec4(texture2D(texTest, vUv).xyz, 1);
          #else
            gl_FragColor = texture2D(texTest, vUv);
          #endif
        }
    </script>

    <script src="js/thirdparty/stats.min.js"></script>
    <script src="js/thirdparty/gl-matrix.js"></script>
    <script src="js/util/EventEmitter.js"></script>
    <script src="js/core.js"></script>
    <script src="js/io.js"></script>
    <script src="js/rendering/Geometry.js"></script>
    <script src="js/rendering/Renderer.js"></script>
    <script src="js/rendering/Shader.js"></script>
    <script src="js/rendering/Texture.js"></script>
    <script src="js/scene/SimpleScene.js"></script>
    <script src="js/scene/StaticScene.js"></script>
    <script src="js/scene/SceneNode.js"></script>
    <script src="js/scene/Mesh.js"></script>
    <script src="js/scene/Camera.js"></script>
    <script src="js/scene/Skeleton.js"></script>
    <script src="jst/util/binaryreader.js"></script>
    <script src="jst/util/roseloader.js"></script>
    <script src="jst/formats/dds.js"></script>
    <script src="jst/formats/rmesh.js"></script>
    <script src="jst/formats/rskeleton.js"></script>
    <script src="jst/formats/ranimation.js"></script>
    <script src="js/animation/AnimationHandler.js"></script>
    <script src="js/animation/Animator.js"></script>
    <script src="jst/test.js"></script>
</body>
</html>